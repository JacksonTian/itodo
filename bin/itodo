#!/usr/bin/env node

/**
 * Module dependencies.
 */

var program = require('commander'),
  fs = require('fs'),
  path = require('path'),
  itodo = require('../');

// options

program
  .version(itodo.version)
  .option('-i, --input <folder>', 'Where is the project');

// examples

program.on('--help', function(){
  console.log('  Examples:');
  console.log('');
  console.log('    $ itodo -i <folder>');
  console.log('');
});

// parse argv
program.parse(process.argv);

if (!program.input) {
  console.log('$ itodo -i <folder>');
} else {
  // process stdin
  itodo.process(program.input, function (err, list) {
    console.log("项目路径：" + program.input);
    if (err) {
      console.log("扫描项目出现错误：");
      console.log(err);
      return;
    }
    if (list.length) {
      console.log("您项目的TODO列表项还有：" + list.length + "项");
      console.log('类型\t|内容\t\t\t\t|行\t|文件名\t\t');
      list.forEach(function (item) {
        console.log('---------------------------------------------------------------------');
        console.log([item.type, item.item, item.lineno, item.filename].join('\t|'));
      });
    } else {
      console.log("恭喜您，项目的TODO列表为空");
    }
  });
}
